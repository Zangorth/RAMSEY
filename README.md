# Ramsey
## Introduction
The goal of this project is to develop some modeling around the Dave Ramsey youtube channel. I hope to do some sentiment analysis and build models to determine what makes him angry/happy/sad etc. and also do some more "useful" modeling around the kinds of videos that are the most popular (using factors such as sentiment, topic of the conversation, etc.). 

Once we have some of that preliminary, and more basic, modeling done, I also think it would be interesting to build a chat bot that allows you to ask Dave questions. He has easily hundreds of hours of content published, and the message is mostly consistent, so I think developing a "What Would Dave Do" bot would be feasible, even if it could require a fair bit of effort. 

## Data Collection
The first step in the project is to collect the data we are going to be using for analysis. In order to do this I [scraped data](https://github.com/Zangorth/RAMSEY/blob/main/Data%20Scrape.py) from the [The Ramsey Show - Highlights](https://www.youtube.com/c/TheRamseyShow) YouTube channel. There are multiple Ramsey show channels, however, I am primarily interested in the call-in segments of the show, which this channel primarily distributes, and the "highlight" format of the channel allows you capture a single call without any extra effort. Similar content could have been scraped from the Ramsey Show Full Episodes channel, however, calls run back to back over a 2-3 hour period, so extra effort would have to be made to pull out and identify individual calls. The downside to this is that not every call is published to the highlights channel, but the benefit of not having to build an additional model identify calls seems worth it. Although, this may be revisited in the future. 

Some results of the data scraping process can be visualized below. The first graph shows the seven day running average of minutes of content published by day. So, if they published a 5 minute video, a 6 minute video, and a 7 minute video during the last seven day period the chart would show a seven day running average of 6 minutes of content published for that day. This was done to reduce the pretty drastic fluctuations in daily content published and helps to present a more clear picture of the trends. The first several years of the channels history have pretty wild fluctuations in amount of content published daily, declining to a low in 2017, and then steadily increasing year over year from that point. 

I also wanted to look at a Day of Week breakdown of this chart, as it wouldn't be uncommon for them to publish less on the weekends since they don't air any live shows on that day. This turned out as expected, with Saturday and Sunday seeing significantly less published content than the business days. 

![plot1](https://github.com/Zangorth/RAMSEY/blob/main/Plots/Amount%20of%20Content%20Published.png)

## Voice Recognition
The second step in the project was to build a model that was able to accurately identify who was speaking during each second for each video. Potential speakers included Ramsey, the Guest Caller, and each of the personalities (Delony, AO, Hogan, Coleman, and Rachel Cruze. There was also an option for no speaker, as there are a substantial number of individual seconds in which no one in particular is speaking. Originally I also attempted to include a class for multiple individuals speaking at the same time, however, this tended to hurt the fit of the model more than it helped, so I ended up just identifying who the primary speaker in each clip was. 

I trained the model on about an hour of content. In principle you don't need quite so many voice clips to identify a person's voice, however, the data was very imbalanced, with Ramsey speaking 60%-70% of the time on average and the guest speaking 30%-40% of the time on average. This often left <5% of the total speaking time to individual hosts across the sample, so getting a good number of clips from the other personalities was somewhat challenging. I was able to get around this to some extent by oversampling from 2020 and 2021 (when the personalities became more regular hosts), but even during these time periods the hosts tend to take up less than 15% of the speaking time. In order to further combat this, we used SMOTE (synthetic over-sampling) to further boost the performance of minority classes. 

The final model chosen was a neural network with three layers. This model was arrived at using an optimization algorithm which selected the best model (choosing between logit, random forest, gradient boosting classifier, and neural network) with the best hyper-parameters, based on out of sample F1 score. The neural network out performed other models, and acheived a cross validated F1 of 0.9, which was the target F1 score. 

Visualizations of the speaker data are presented below. Across the entire time frame most of the shows feature a call between Ramsey and the Guest, with no co-host personality. In 2020, however, Ramsey begins regularly bringing on co-hosts to help him take calls on the show. Of these co-hosts, Delony is the most popular, managing to take up between 10 and 15 percent of the talk time. By contrast, Rachel Cruze and Christy Wright tend to speak the least, with a combined talk time of less than 5 percent in most cases. 

![plot2](https://github.com/Zangorth/RAMSEY/blob/main/Plots/Speaker%20Percent.png)

