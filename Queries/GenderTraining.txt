SET NOCOUNT ON

SELECT channel, id, [second]
INTO #gender
FROM ramsey.training
UNION
SELECT channel, id, [second]-1
FROM ramsey.training
UNION
SELECT channel, id, [second]-2
FROM ramsey.training
UNION
SELECT channel, id, [second]-3
FROM ramsey.training
UNION
SELECT channel, id, [second]-4
FROM ramsey.training
UNION
SELECT channel, id, [second]-5
FROM ramsey.training
UNION
SELECT channel, id, [second]+1
FROM ramsey.training
UNION
SELECT channel, id, [second]+2
FROM ramsey.training
UNION
SELECT channel, id, [second]+3
FROM ramsey.training
UNION
SELECT channel, id, [second]+4
FROM ramsey.training
UNION
SELECT channel, id, [second]+5
FROM ramsey.training


SELECT gender, DATEDIFF(MONTH, publish_date, GETDATE()) AS 'age', audio.*
FROM #gender
LEFT JOIN ramsey.training AS train
    ON #gender.channel = train.channel
    AND #gender.id = train.id
    AND #gender.[second] = train.[second]
LEFT JOIN ramsey.audio
    ON #gender.channel = audio.channel
    AND #gender.id = audio.id
    AND #gender.[second] = audio.[second]
LEFT JOIN ramsey.metadata
    ON #gender.channel = metadata.channel
    AND #gender.id = metadata.id
WHERE audio.id IS NOT NULL
ORDER BY audio.channel, audio.id, audio.[second]